# üõ°Ô∏è Scripts de Pentesting

Esta carpeta contiene scripts completos de pentesting que incluyen enumeraci√≥n, escaneo de vulnerabilidades, fuzzing y an√°lisis de seguridad.

---

## üìã Scripts Disponibles

### 1. `pentesting_completo.sh` üî•

**Suite completa de pentesting y auditor√≠a de seguridad**

**Descripci√≥n:**
Script exhaustivo que realiza un an√°lisis completo de seguridad incluyendo:
- Enumeraci√≥n de subdominios y URLs
- Escaneo de vulnerabilidades
- Escaneo de puertos
- Fuzzing de directorios
- An√°lisis de headers de seguridad
- Reportes detallados

**Cu√°ndo usarlo:**
- Auditor√≠as de seguridad completas
- Reportes profesionales de seguridad
- An√°lisis exhaustivo de seguridad
- Pentesting completo

**Dependencias (usa las que encuentre):**
- `subfinder` - Enumeraci√≥n de subdominios
- `assetfinder` - B√∫squeda de assets
- `waybackurls` - URLs hist√≥ricas
- `gau` - Get All URLs
- `katana` - Crawling
- `nuclei` - Escaneo de vulnerabilidades ‚ö†Ô∏è
- `naabu` - Escaneo de puertos
- `httpx` - Verificaci√≥n HTTP
- `dnsx` - Consulta DNS
- `ffuf` - Fuzzing
- `curl` - An√°lisis de headers

**Uso:**
```bash
# 1. Editar el script para cambiar:
URL_INPUT="https://example.com/"

# 2. Ejecutar
./pentesting_completo.sh
```

---

## üîç Estructura del Script

### FASE 1: Enumeraci√≥n de Subdominios
```
‚îú‚îÄ‚îÄ subfinder - Enumeraci√≥n pasiva
‚îú‚îÄ‚îÄ assetfinder - B√∫squeda de assets
‚îî‚îÄ‚îÄ httpx - Verificaci√≥n de subdominios activos
```

### FASE 2: Enumeraci√≥n de URLs
```
‚îú‚îÄ‚îÄ waybackurls - URLs hist√≥ricas
‚îú‚îÄ‚îÄ gau - Get All URLs
‚îî‚îÄ‚îÄ katana - Crawling con JavaScript
```

### FASE 3: Filtrado y Organizaci√≥n
```
‚îú‚îÄ‚îÄ URLs con par√°metros (potenciales XSS/SQLi)
‚îú‚îÄ‚îÄ Archivos sensibles (.php, .config, .env, etc.)
‚îî‚îÄ‚îÄ Directorios sensibles (admin, login, api, etc.)
```

### FASE 4: Escaneo de Vulnerabilidades
```
‚îú‚îÄ‚îÄ nuclei - URL principal
‚îú‚îÄ‚îÄ nuclei - Subdominios activos
‚îî‚îÄ‚îÄ nuclei - URLs con par√°metros
```

### FASE 5: Escaneo de Puertos
```
‚îî‚îÄ‚îÄ naabu - Puertos abiertos
```

### FASE 6: Fuzzing
```
‚îî‚îÄ‚îÄ ffuf - Directorios comunes (admin, login, api, etc.)
```

### FASE 7: An√°lisis de Informaci√≥n Expuesta
```
‚îî‚îÄ‚îÄ An√°lisis de headers de seguridad
    ‚îú‚îÄ‚îÄ Server
    ‚îú‚îÄ‚îÄ X-Powered-By
    ‚îú‚îÄ‚îÄ X-Frame-Options
    ‚îú‚îÄ‚îÄ Content-Security-Policy
    ‚îî‚îÄ‚îÄ Strict-Transport-Security
```

### FASE 8: Generaci√≥n de Reporte
```
‚îî‚îÄ‚îÄ Reporte completo con:
    ‚îú‚îÄ‚îÄ Estad√≠sticas
    ‚îú‚îÄ‚îÄ Vulnerabilidades encontradas
    ‚îú‚îÄ‚îÄ P√°ginas sensibles
    ‚îî‚îÄ‚îÄ Recomendaciones
```

---

## üìÅ Archivos Generados

Todos los archivos se guardan en: `scan_{dominio}_{fecha}/`

### Enumeraci√≥n
- `subdominios.txt` - Subdominios encontrados
- `subdominios_activos.txt` - Subdominios verificados
- `todas_urls.txt` - Todas las URLs encontradas
- `urls_con_parametros.txt` - URLs con par√°metros GET
- `archivos_sensibles.txt` - Archivos potencialmente sensibles
- `directorios_sensibles.txt` - Directorios administrativos/sensibles

### Seguridad
- `nuclei_principal.txt` - Vulnerabilidades en URL principal
- `nuclei_subdominios.txt` - Vulnerabilidades en subdominios
- `nuclei_parametros.txt` - Vulnerabilidades en URLs con par√°metros
- `puertos_abiertos.txt` - Puertos abiertos encontrados
- `fuzzing_directorios.json` - Resultados de fuzzing
- `headers.txt` - Headers HTTP completos
- `analisis_headers.txt` - An√°lisis de headers de seguridad

### Reportes
- `reporte_final.txt` - Reporte completo con estad√≠sticas y recomendaciones

---

## üì¶ Instalaci√≥n de Dependencias

### Herramientas B√°sicas
```bash
export PATH=$PATH:$(go env GOPATH)/bin

# Enumeraci√≥n
go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest
go install github.com/tomnomnom/assetfinder@latest
go install github.com/tomnomnom/waybackurls@latest
go install github.com/lc/gau/v2/cmd/gau@latest
go install github.com/projectdiscovery/katana/cmd/katana@latest
go install -v github.com/projectdiscovery/httpx/cmd/httpx@latest
go install -v github.com/projectdiscovery/dnsx/cmd/dnsx@latest
```

### Herramientas de Seguridad
```bash
# Nuclei (escaneo de vulnerabilidades)
go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest
nuclei -update-templates  # Actualizar plantillas

# Naabu (escaneo de puertos)
go install -v github.com/projectdiscovery/naabu/v2/cmd/naabu@latest

# FFuf (fuzzing)
go install github.com/ffuf/ffuf/v2@latest
```

---

## üéØ Caracter√≠sticas Especiales

### 1. Escaneo de Vulnerabilidades con Nuclei
- Escanea URL principal
- Escanea subdominios activos
- Escanea URLs con par√°metros
- Usa plantillas actualizadas de Nuclei

### 2. Escaneo de Puertos
- Identifica puertos abiertos
- √ötil para descubrir servicios expuestos

### 3. Fuzzing de Directorios
- Prueba directorios comunes
- Wordlist incluida (admin, login, api, etc.)
- Filtra por c√≥digos de estado 200, 301, 302

### 4. An√°lisis de Headers
- Detecta informaci√≥n expuesta (Server, X-Powered-By)
- Verifica headers de seguridad
- Identifica configuraciones inseguras

### 5. Reporte Completo
- Estad√≠sticas detalladas
- Vulnerabilidades encontradas
- P√°ginas sensibles
- Recomendaciones inmediatas

---

## üìä Ejemplo de Salida

```
üéØ Escaneo de seguridad para: example.com
==========================================

[INFO] Verificando herramientas de seguridad...
[SUCCESS] subfinder - Enumeraci√≥n de subdominios
[SUCCESS] waybackurls - URLs hist√≥ricas
[WARN] nuclei - No instalado

[INFO] Iniciando enumeraci√≥n de subdominios...
[INFO] Ejecutando subfinder...
[INFO] Subfinder encontr√≥ 25 subdominios

[INFO] Recolectando URLs...
[INFO] Consultando Wayback Machine...
[INFO] Waybackurls encontr√≥ 1250 URLs

[INFO] Filtrando URLs potencialmente vulnerables...

[INFO] Ejecutando escaneo de vulnerabilidades con Nuclei...

‚úÖ ESCANEO COMPLETADO!
üìÅ Resultados en: scan_example_20240101_120000

üìä ESTAD√çSTICAS:
   ‚Ä¢ Subdominios: 25
   ‚Ä¢ URLs totales: 1250
   ‚Ä¢ URLs con par√°metros: 340

üö® HALLAZGOS IMPORTANTES:
   üî¥ Vulnerabilidades: 3
   üü° Archivos sensibles: 12
```

---

## ‚ö†Ô∏è Advertencias Importantes

1. **Permisos:** Solo usa en sistemas que posees o tienes autorizaci√≥n escrita para probar
2. **Nuclei:** Actualiza las plantillas regularmente: `nuclei -update-templates`
3. **Rate Limits:** Algunas herramientas pueden hacer muchas peticiones
4. **Tiempo:** Este script puede tardar mucho tiempo dependiendo del tama√±o del dominio
5. **Recursos:** Puede consumir muchos recursos del sistema

---

## üîß Configuraci√≥n

### Editar el Script
```bash
# Buscar y modificar:
URL_INPUT="https://example.com/"
```

### Personalizar Wordlist de Fuzzing
Editar la secci√≥n de fuzzing para agregar m√°s directorios:
```bash
cat > "$DIR_RESULTADOS/wordlist_temp.txt" << 'EOF'
admin
login
dashboard
# Agregar m√°s aqu√≠...
EOF
```

---

## üí° Tips de Uso

1. **Ejecutar en background:** Para scripts largos
   ```bash
   nohup ./pentesting_completo.sh > output.log 2>&1 &
   ```

2. **Limitar subdominios:** Si hay muchos, edita el script para limitar:
   ```bash
   head -50 "$DIR_RESULTADOS/subdominios.txt" | ...
   ```

3. **Revisar reporte:** Siempre revisa `reporte_final.txt` primero

4. **Actualizar Nuclei:** Antes de cada uso:
   ```bash
   nuclei -update-templates
   ```

---

## üìã Checklist Pre-Ejecuci√≥n

- [ ] Tener autorizaci√≥n escrita para pentesting
- [ ] Instalar todas las dependencias
- [ ] Actualizar plantillas de Nuclei
- [ ] Editar URL_INPUT en el script
- [ ] Verificar permisos de ejecuci√≥n
- [ ] Tener suficiente espacio en disco
- [ ] Considerar ejecutar en background si es un dominio grande

---

**Ver el [README principal](../README.md) para documentaci√≥n completa.**

